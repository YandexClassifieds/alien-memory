
        <!DOCTYPE html>
        <html lang="ru" dir="ltr">
            <head>
                <meta charset="utf-8">
                <base href="../" />
                
                
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Layout</title>
                <style type="text/css">
                    body {
                        height: 100vh;
                    }
                </style>
                <link type="text/css" rel="stylesheet" href="_bundle/vendor.css" />
<link type="text/css" rel="stylesheet" href="_bundle/app.css" />
                
                
            </head>
            <body class="g-root g-root_theme_light">
                <div id="root"></div>
                <script type="application/javascript">
                   window.STATIC_CONTENT = false
                   window.__DATA__ = {"data":{"meta":{"metadata":[],"style":[],"script":[],"csp":[]},"assets":[],"headings":[],"title":"Layout","includes":[],"html":"<p>Layout - описание схемы данных, хранящихся в памяти. В основе лежит <code>java.lang.foreign.MemoryLayout</code>.</p>\n<p>Схема собирается из кирпичиков:</p>\n<ul>\n<li>\n<p><code>Value</code> - элементарный слой для целых чисел, символов и т.д.</p>\n\n    <div class=\"yfm-clipboard\">\n        <pre><code class=\"hljs scala\"><span class=\"hljs-keyword\">val</span> a = <span class=\"hljs-type\">Values</span>.<span class=\"hljs-type\">Long</span> <span class=\"hljs-comment\">//  слой под Long значения</span>\n</code></pre>\n\n        <button class=\"yfm-clipboard-button\">\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"11\">\n                <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n                <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n                    <animate id=\"visibileAnimation-11\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n                    <animate id=\"hideAnimation-11\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-11.end+1\" fill=\"freeze\"></animate>\n                </path>\n            </svg>\n        </button>\n    </div>\n</li>\n<li>\n<p><code>BoundedSequence</code> - контейнер для последовательности данных одного типа.<br />\nУпрощенно можно собирать последовательности с помощью оператора *, это повышает читабельность для матриц.</p>\n\n    <div class=\"yfm-clipboard\">\n        <pre><code class=\"hljs scala\"><span class=\"hljs-keyword\">val</span> a = <span class=\"hljs-type\">Values</span>.<span class=\"hljs-type\">Long</span> * <span class=\"hljs-number\">2</span> * <span class=\"hljs-number\">5</span> <span class=\"hljs-comment\">// матрица с 5 строчками и 2 столбцами</span>\n</code></pre>\n\n        <button class=\"yfm-clipboard-button\">\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"17\">\n                <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n                <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n                    <animate id=\"visibileAnimation-17\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n                    <animate id=\"hideAnimation-17\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-17.end+1\" fill=\"freeze\"></animate>\n                </path>\n            </svg>\n        </button>\n    </div>\n</li>\n<li>\n<p><code>Aligned</code> - контейнер группы данных, который задает выравнивание в байтах для нижележащих данных.</p>\n\n    <div class=\"yfm-clipboard\">\n        <pre><code class=\"hljs scala\"><span class=\"hljs-keyword\">val</span> aligned = (<span class=\"hljs-type\">Values</span>.<span class=\"hljs-type\">Long</span> * <span class=\"hljs-number\">2</span> * <span class=\"hljs-number\">5</span>).align[`<span class=\"hljs-number\">2</span>^<span class=\"hljs-number\">8</span>`] <span class=\"hljs-comment\">//  обеспечивает выделение памяти по адресу, кратному 256.</span>\n</code></pre>\n\n        <button class=\"yfm-clipboard-button\">\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"23\">\n                <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n                <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n                    <animate id=\"visibileAnimation-23\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n                    <animate id=\"hideAnimation-23\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-23.end+1\" fill=\"freeze\"></animate>\n                </path>\n            </svg>\n        </button>\n    </div>\n</li>\n<li>\n<p><code>Padding</code> - \"Пробел\" в памяти, который не хранит данные, но добавляет смещение в байтах перед следующим элементом.</p>\n\n    <div class=\"yfm-clipboard\">\n        <pre><code class=\"hljs scala\"><span class=\"hljs-keyword\">val</span> onlyPadding = <span class=\"hljs-type\">Padding</span>(<span class=\"hljs-number\">32</span>) <span class=\"hljs-comment\">// 32 пустых байта</span>\n</code></pre>\n\n        <button class=\"yfm-clipboard-button\">\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"29\">\n                <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n                <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n                    <animate id=\"visibileAnimation-29\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n                    <animate id=\"hideAnimation-29\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-29.end+1\" fill=\"freeze\"></animate>\n                </path>\n            </svg>\n        </button>\n    </div>\n</li>\n<li>\n<p><code>Dynamic</code> - контейнер группы данных. Выделяются два типа: структуры и объединения.</p>\n<p><a href=\"https://ru.wikipedia.org/wiki/%D0%A1%D1%82%D1%80%D1%83%D0%BA%D1%82%D1%83%D1%80%D0%B0_(%D1%8F%D0%B7%D1%8B%D0%BA_%D0%A1%D0%B8)\" target=\"_blank\" rel=\"noreferrer noopener\">Структуры</a> записывают в память данные своих полей последовательно(<br />\nто же самое что и struct из C).</p>\n<p><a href=\"https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D1%8A%D0%B5%D0%B4%D0%B8%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5_(%D1%81%D1%82%D1%80%D1%83%D0%BA%D1%82%D1%83%D1%80%D0%B0_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85)\" target=\"_blank\" rel=\"noreferrer noopener\">Объединения</a> же могут содержать что-то одно из 2 (то же<br />\nсамое что и union из C)</p>\n<p>В alien для конструирования dynamic layout используются операторы:</p>\n\n    <div class=\"yfm-clipboard\">\n        <pre><code class=\"hljs scala\">&lt;&gt;: - дополнение текущего объединения другим объединением\n\n&gt;&gt; - инициализация слоя: переданный в такой конструктор name := layout теперь считается структурой или обьеденением из одного элемента\n\n&gt;&gt;: - дополнение текущей структуры другой структурой\n</code></pre>\n\n        <button class=\"yfm-clipboard-button\">\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"44\">\n                <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n                <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n                    <animate id=\"visibileAnimation-44\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n                    <animate id=\"hideAnimation-44\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-44.end+1\" fill=\"freeze\"></animate>\n                </path>\n            </svg>\n        </button>\n    </div>\n<p>Части структур и объединений нужно именовать с помощью оператора <code>:=</code>.<br />\nПример:</p>\n\n    <div class=\"yfm-clipboard\">\n        <pre><code class=\"hljs scala\"><span class=\"hljs-keyword\">val</span> a = <span class=\"hljs-string\">\"matrix\"</span> := <span class=\"hljs-type\">Values</span>.<span class=\"hljs-type\">Long</span> * <span class=\"hljs-number\">7</span> * <span class=\"hljs-number\">2</span> <span class=\"hljs-comment\">// матрица с именем matrix</span>\n<span class=\"hljs-keyword\">val</span> b = <span class=\"hljs-string\">\"array\"</span> := <span class=\"hljs-type\">Values</span>.<span class=\"hljs-type\">Long</span> * <span class=\"hljs-number\">5</span> <span class=\"hljs-comment\">// массив с именем array</span>\n<span class=\"hljs-keyword\">val</span> layout: (<span class=\"hljs-string\">\"matrix\"</span> := <span class=\"hljs-type\">BoundedSequence</span>[<span class=\"hljs-type\">BoundedSequence</span>[<span class=\"hljs-type\">Value</span>[<span class=\"hljs-type\">Long</span>]]]) &gt;&gt;: \n            (&gt;&gt;[<span class=\"hljs-string\">\"array\"</span> := <span class=\"hljs-type\">BoundedSequence</span>[<span class=\"hljs-type\">Value</span>[<span class=\"hljs-type\">Long</span>]]]) = a &gt;&gt;: b <span class=\"hljs-comment\">// структура из матрицы и массива</span>\n</code></pre>\n\n        <button class=\"yfm-clipboard-button\">\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"48\">\n                <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n                <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n                    <animate id=\"visibileAnimation-48\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n                    <animate id=\"hideAnimation-48\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-48.end+1\" fill=\"freeze\"></animate>\n                </path>\n            </svg>\n        </button>\n    </div>\n</li>\n</ul>\n<h3 id=\"note\"><a href=\"pages/layouts.html#note\" class=\"yfm-anchor\" aria-hidden=\"true\"><span class=\"visually-hidden\" data-no-index=\"true\">Note</span></a>Note</h3>\n<p>При построении <code>Layout</code> нужно учитывать, что действует обратная (правая) ассоциативность. Например, при создании<br />\nматрицы</p>\n\n    <div class=\"yfm-clipboard\">\n        <pre><code class=\"hljs scala\"><span class=\"hljs-keyword\">val</span> memL = <span class=\"hljs-string\">\"bitmap\"</span> := (<span class=\"hljs-type\">Values</span>.<span class=\"hljs-type\">Long</span> * height) * width\n</code></pre>\n\n        <button class=\"yfm-clipboard-button\">\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"57\">\n                <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n                <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n                    <animate id=\"visibileAnimation-57\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n                    <animate id=\"hideAnimation-57\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-57.end+1\" fill=\"freeze\"></animate>\n                </path>\n            </svg>\n        </button>\n    </div>\n<p>Сначала создается одна строка из height ячеек, затем эта строка масштабируется по ширине (width).</p>\n","leading":false},"router":{"pathname":"pages/layouts","depth":2},"lang":"ru","langs":["ru"]};
                </script>
                <script src="toc.js" type="application/javascript"></script>
                <script type="application/javascript" src="_bundle/react.js"></script>
<script type="application/javascript" src="_bundle/app.js"></script>
<script type="application/javascript" src="_bundle/vendor.js"></script>
            </body>
        </html>
    